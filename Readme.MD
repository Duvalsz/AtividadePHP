# ğŸ“‹ DocumentaÃ§Ã£o da API de UsuÃ¡rios - sistema_api

## ğŸ“– Ãndice
- [VisÃ£o Geral](#-visÃ£o-geral)
- [Estrutura de Arquivos](#-estrutura-de-arquivos)
- [PrÃ©-requisitos](#-prÃ©-requisitos)
- [ConfiguraÃ§Ã£o do Banco de Dados](#-configuraÃ§Ã£o-do-banco-de-dados)
- [Endpoints da API](#-endpoints-da-api)
  - [Criar UsuÃ¡rio](#1-criar-usuÃ¡rio-post)
  - [Excluir UsuÃ¡rio](#2-excluir-usuÃ¡rio-delete)
  - [Login](#3-login-post)
- [Estrutura de Dados](#-estrutura-de-dados)
- [ValidaÃ§Ãµes](#-validaÃ§Ãµes)
- [Exemplos de Uso](#-exemplos-de-uso)
- [Tratamento de Erros](#-tratamento-de-erros)
- [Testes](#-testes)
- [FunÃ§Ãµes UtilitÃ¡rias](#-funÃ§Ãµes-utilitÃ¡rias)
- [Suporte](#-suporte)

## ğŸ¯ VisÃ£o Geral

API RESTful para gerenciamento de usuÃ¡rios com sistema de autenticaÃ§Ã£o. Desenvolvida em PHP com MySQL, oferece operaÃ§Ãµes CRUD bÃ¡sicas com validaÃ§Ãµes de seguranÃ§a para dados sensÃ­veis.

## ğŸ“ Estrutura de Arquivos

```
sistema_api/
â”œâ”€â”€ api_noite.php          # Endpoint principal (POST/DELETE)
â”œâ”€â”€ delete.php             # Endpoint alternativo para DELETE
â”œâ”€â”€ login.php              # Endpoint para autenticaÃ§Ã£o
â”œâ”€â”€ db.php                 # ConfiguraÃ§Ã£o de conexÃ£o com banco
â”œâ”€â”€ utils.php              # FunÃ§Ãµes utilitÃ¡rias
â”œâ”€â”€ DVLMasterofBitching.sql # Script de criaÃ§Ã£o do banco
â”œâ”€â”€ teste.http             # Exemplos de requisiÃ§Ãµes
â””â”€â”€ README.md              # Esta documentaÃ§Ã£o
```

## âš™ï¸ PrÃ©-requisitos

- Servidor web (Apache/Nginx)
- PHP 7.4 ou superior
- MySQL 5.7 ou superior
- ExtensÃ£o MySQLi ativada no PHP

## ğŸ—„ï¸ ConfiguraÃ§Ã£o do Banco de Dados

1. Execute o script SQL para criar o banco e tabela:

```sql
CREATE DATABASE IF NOT EXISTS sistema_api;
USE sistema_api;

CREATE TABLE api_usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    uuid CHAR(36) NOT NULL UNIQUE,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(150) NOT NULL UNIQUE, 
    senha VARCHAR(255) NOT NULL,
    telefone VARCHAR(20) NOT NULL,
    endereco VARCHAR(200) NOT NULL,
    estado CHAR(2) NOT NULL,
    data_nascimento DATE NOT NULL, 
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

2. Configure as credenciais do banco no arquivo `db.php`:

```php
<?php
$host = "localhost";
$user = "root";
$pass = "aluno"; // Altere conforme sua configuraÃ§Ã£o
$db   = "sistema_api";

$conn = new mysqli($host, $user, $pass, $db);
// ... resto do cÃ³digo
```

## ğŸŒ Endpoints da API

### 1. Criar UsuÃ¡rio (POST)
**Endpoint:** `/api_noite.php`

**Headers:**
```
Content-Type: application/json
```

**Body:**
```json
{
  "nome": "Maria Silva",
  "email": "maria.silva@example.com",
  "senha": "Senha@123",
  "telefone": "11987654321",
  "endereco": "Rua das Flores, 456",
  "estado": "RJ",
  "data_nascimento": "1995-05-10"
}
```

**Respostas:**
- `201 Created`: UsuÃ¡rio criado com sucesso
- `400 Bad Request`: Dados invÃ¡lidos ou faltantes
- `409 Conflict`: E-mail jÃ¡ cadastrado
- `500 Internal Server Error`: Erro no servidor

### 2. Excluir UsuÃ¡rio (DELETE)
**Endpoint:** `/api_noite.php?uuid={uuid}`

**ParÃ¢metro URL:** `uuid` - Identificador Ãºnico do usuÃ¡rio

**Respostas:**
- `200 OK`: UsuÃ¡rio excluÃ­do com sucesso
- `400 Bad Request`: UUID nÃ£o fornecido
- `404 Not Found`: UsuÃ¡rio nÃ£o encontrado
- `500 Internal Server Error`: Erro no servidor

### 3. Login (POST)
**Endpoint:** `/login.php`

**Headers:**
```
Content-Type: application/json
```

**Body:**
```json
{
  "email": "maria.silva@example.com",
  "senha": "Senha@123"
}
```

**Resposta de Sucesso:**
```json
{
  "mensagem": "Login realizado com sucesso.",
  "usuario": {
    "id": 1,
    "uuid": "550e8400-e29b-41d4-a716-446655440000",
    "nome": "Maria Silva",
    "email": "maria.silva@example.com",
    "telefone": "11987654321",
    "endereco": "Rua das Flores, 456",
    "estado": "RJ",
    "data_nascimento": "1995-05-10",
    "criado_em": "2023-10-15 14:30:00"
  }
}
```

## ğŸ“Š Estrutura de Dados

### Tabela: `api_usuarios`
| Campo | Tipo | ObrigatÃ³rio | DescriÃ§Ã£o |
|-------|------|-------------|-----------|
| id | INT | âœ… | Chave primÃ¡ria autoincrementÃ¡vel |
| uuid | CHAR(36) | âœ… | Identificador Ãºnico universal |
| nome | VARCHAR(100) | âœ… | Nome completo do usuÃ¡rio |
| email | VARCHAR(150) | âœ… | E-mail Ãºnico do usuÃ¡rio |
| senha | VARCHAR(255) | âœ… | Hash da senha |
| telefone | VARCHAR(20) | âœ… | NÃºmero de telefone |
| endereco | VARCHAR(200) | âœ… | EndereÃ§o completo |
| estado | CHAR(2) | âœ… | Sigla do estado (ex: SP, RJ) |
| data_nascimento | DATE | âœ… | Data de nascimento |
| criado_em | TIMESTAMP | âœ… | Data de criaÃ§Ã£o do registro |

## ğŸ”’ ValidaÃ§Ãµes

### Senha
- MÃ­nimo 8 caracteres
- Pelo menos 1 letra maiÃºscula
- Pelo menos 1 letra minÃºscula  
- Pelo menos 1 nÃºmero
- Pelo menos 1 caractere especial (@$!%*?&)

### Telefone
- Apenas nÃºmeros
- 10 ou 11 dÃ­gitos

### E-mail
- Formato vÃ¡lido de e-mail
- Ãšnico no sistema

### Campos ObrigatÃ³rios
Todos os campos sÃ£o obrigatÃ³rios para criaÃ§Ã£o de usuÃ¡rio.

## ğŸ§ª Exemplos de Uso

### Criar usuÃ¡rio
```bash
curl -X POST http://localhost/api_noite.php \
  -H "Content-Type: application/json" \
  -d '{
    "nome": "JoÃ£o Santos",
    "email": "joao.santos@example.com",
    "senha": "Senha@123",
    "telefone": "11999998888",
    "endereco": "Av. Principal, 123",
    "estado": "SP",
    "data_nascimento": "1990-01-15"
  }'
```

### Excluir usuÃ¡rio
```bash
curl -X DELETE "http://localhost/api_noite.php?uuid=550e8400-e29b-41d4-a716-446655440000"
```

### Login
```bash
curl -X POST http://localhost/login.php \
  -H "Content-Type: application/json" \
  -d '{
    "email": "joao.santos@example.com",
    "senha": "Senha@123"
  }'
```

## âš ï¸ Tratamento de Erros

A API retorna respostas padronizadas com cÃ³digos HTTP apropriados:

- `200`: Sucesso
- `400`: RequisiÃ§Ã£o invÃ¡lida (dados faltantes ou invÃ¡lidos)
- `401`: NÃ£o autorizado (credenciais invÃ¡lidas)
- `404`: Recurso nÃ£o encontrado
- `409`: Conflito (e-mail duplicado)
- `500`: Erro interno do servidor

Exemplo de resposta de erro:
```json
{
  "erro": "A senha deve ter pelo menos 1 caractere especial."
}
```

## ğŸ§ª Testes

Use o arquivo `teste.http` com a extensÃ£o REST Client do VSCode para testar os endpoints:

```http
### Criar cliente
POST http://localhost/api_noite.php
Content-Type: application/json

{
  "nome": "Maria Silva",
  "email": "maria.silva@example.com",
  "senha": "Senha@123",
  "telefone": "11987654321",
  "endereco": "Rua das Flores, 456",
  "estado": "RJ",
  "data_nascimento": "1995-05-10"
}

### Deletar cliente
DELETE http://localhost/api_noite.php?uuid=COLE-O-UUID-AQUI
```

## ğŸ”§ FunÃ§Ãµes UtilitÃ¡rias

O arquivo `utils.php` contÃ©m funÃ§Ãµes essenciais:

- `gerarUuid()`: Gera UUID v4 para identificaÃ§Ã£o Ãºnica
- `validarSenha($senha)`: Valida forÃ§a da senha
- `validarTelefone($telefone)`: Valida formato do telefone

## ğŸ“ Suporte

Para dÃºvidas ou problemas, verifique:
1. ConfiguraÃ§Ã£o do banco de dados no arquivo `db.php`
2. PermissÃµes de escrita no servidor
3. Logs de erro do PHP e MySQL